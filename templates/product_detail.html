{% load static %}
<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <title>{{ product.name }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container py-5">
    <div class="row">
        <!-- ØªØµÙˆÛŒØ± Ù…Ø­ØµÙˆÙ„ -->
        <div class="col-md-6">
            {% if product.image %}
                <img src="{{ product.image.url }}" class="img-fluid rounded shadow">
            {% else %}
                <img src="{% static 'images/no-image.png' %}" class="img-fluid rounded shadow">
            {% endif %}
        </div>

        <!-- ØªÙˆØ¶ÛŒØ­Ø§Øª Ù…Ø­ØµÙˆÙ„ -->
        <div class="col-md-6">
            <h1>{{ product.name }}</h1>
            <p class="text-muted">ğŸ’° Ù‚ÛŒÙ…Øª: {{ product.price }} ØªÙˆÙ…Ø§Ù†</p>
            <p>{{ product.description }}</p>

            <div class="d-flex gap-2 mt-3">
                <button class="btn btn-primary" onclick="addToCart({{ product.id }})">ğŸ›’ Ø§ÙØ²ÙˆØ¯Ù† Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯</button>
                <a href="{% url 'cart_view' %}" class="btn btn-success">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯</a>
            </div>
        </div>
    </div>
</div>

<script>
const API_CART = "http://localhost:8000/api/cart/";

// ğŸŸ¢ Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø­ØµÙˆÙ„ Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯
function addToCart(productId) {
    fetch(API_CART + "add_item/", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "X-CSRFToken": "{{ csrf_token }}"
        },
        body: JSON.stringify({
            product_id: productId,
            quantity: 1
        })
    })
    .then(res => res.json())
    .then(data => {
        alert("âœ… Ù…Ø­ØµÙˆÙ„ Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯!");
    })
    .catch(err => alert("âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø­ØµÙˆÙ„!"));
}
</script>

</body>
</html>
